{"version":3,"sources":["user/style.js","user/component/editRoute.js"],"names":["LoginWrapper","styled","div","RegisterWrapper","TableWrapper","Expired","span","Revoke","EditWrapper","Title","h1","EditForm","props","handleSubmit","e","preventDefault","id","state","id_company","user","form","validateFieldsAndScroll","err","values","data","time","format","handleModRoute","console","log","handleAddRoute","axios","get","then","res","success","route","setState","catch","error","warn","method","url","headers","Qs","stringify","info","msg","history","push","this","match","params","getRouteByParamId","getFieldDecorator","name","flight","flightPrice","hotel","hotelPrice","other","period","role","labelCol","xs","sm","wrapperCol","onSubmit","Item","label","initialValue","rules","required","message","type","moment","offset","htmlType","to","React","Component","EditRoute","create","connect"],"mappings":"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","file":"static/js/12.21b1495f.chunk.js","sourcesContent":["import styled from \"styled-components\";\r\n\r\nexport const LoginWrapper = styled.div`\r\n  width: 370px;\r\n  margin: 50px auto 0;\r\n  padding: 50px 20px;\r\n  background-color: #fff;\r\n`;\r\n\r\nexport const RegisterWrapper = styled.div`\r\n  width: 400px;\r\n  margin: 30px auto 0;\r\n  padding: 20px 20px 50px;\r\n  background-color: #fff;\r\n`;\r\n\r\nexport const TableWrapper = styled.div`\r\n  width: 100%;\r\n  background-color: #fff;\r\n  padding: 15px;\r\n  border-radius: 8px;\r\n`;\r\n\r\nexport const Expired = styled.span`\r\n  cursor: pointer;\r\n  padding: 5px 10px;\r\n  border-radius: 5px;\r\n  background-color: #f5f5f5;\r\n  color: #c9c9c9;\r\n  border: 1px solid #c9c9c9;\r\n`;\r\n\r\nexport const Revoke = styled.span`\r\n  cursor: pointer;\r\n  padding: 6px 11px;\r\n  border-radius: 5px;\r\n  background-color: #26bcd5;\r\n  color: #fff;\r\n`;\r\n\r\nexport const EditWrapper = styled.div`\r\n  width: 400px;\r\n  margin: 0 auto;\r\n`;\r\n\r\nexport const Title = styled.h1`\r\n  font-size: 20px;\r\n  font-weight: bold;\r\n  color: #38f;\r\n  text-align: center;\r\n`;\r\n","import React from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport { Redirect } from \"react-router-dom\";\r\nimport axios from \"axios\";\r\nimport Qs from \"qs\";\r\nimport moment from \"moment\";\r\nimport { Form, Input, InputNumber, DatePicker, Button, message } from \"antd\";\r\nimport { TableWrapper, EditWrapper, Title } from \"../style\";\r\n\r\nclass EditForm extends React.Component {\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {id: null};\r\n  }\r\n\r\n  getRouteByParamId(id) {\r\n    axios.get(`/route/oneRoute?id=${id}`).then(res => {\r\n      if(res.data.success) {\r\n        console.log(res.data.route);\r\n        this.setState(res.data.route);\r\n      }\r\n    }).catch(error => {\r\n      console.log(error);\r\n      message.warn(\"初始化失败，请稍后再试\");\r\n    })\r\n  }\r\n\r\n  handleModRoute(data) {\r\n    axios({\r\n      method: \"post\",\r\n      url: \"/route/modRoute\",\r\n      headers: {\"contentType\": \"application/x-www-form-urlencoded\"},\r\n      data: Qs.stringify(data)\r\n    }).then(res => {\r\n      message.info(res.data.msg);\r\n      if(res.data.success) {\r\n        this.props.history.push(\"/myRoute\");\r\n      }\r\n    }).catch(error => {\r\n      console.log(error);\r\n      message.error(\"操作失败，请稍后再试\");\r\n    });\r\n  }\r\n\r\n  handleAddRoute(data) {\r\n    axios({\r\n      method: \"post\",\r\n      url: \"/route/addRoute\",\r\n      headers: {\"contentType\": \"application/x-www-form-urlencoded\"},\r\n      data: Qs.stringify(data)\r\n    }).then(res => {\r\n      message.info(res.data.msg);\r\n      if(res.data.success) {\r\n        this.props.history.push(\"/myRoute\");\r\n      }\r\n    }).catch(error => {\r\n      console.log(error);\r\n      message.error(\"操作失败，请稍后重试\");\r\n    });\r\n  }\r\n\r\n  componentDidMount() {\r\n    const id = this.props.match.params.id;\r\n    if(id) {\r\n      this.getRouteByParamId(id);\r\n    }\r\n  }\r\n\r\n  handleSubmit = e => {\r\n    e.preventDefault();\r\n    const id = this.state.id;\r\n    const id_company = this.props.user.id;\r\n    this.props.form.validateFieldsAndScroll((err, values) => {\r\n      if(!err) {\r\n        if(id) {\r\n          const data = {...values, time: values['time'].format('YYYY-MM-DD'), id};\r\n          this.handleModRoute(data);\r\n        } else {\r\n          const data = {...values, time: values['time'].format('YYYY-MM-DD'), id_company};\r\n          console.log(data);\r\n          this.handleAddRoute(data);\r\n        }\r\n      }\r\n    });\r\n  };\r\n\r\n  render() {\r\n    const { getFieldDecorator } = this.props.form;\r\n    const { name, flight, flightPrice, hotel, hotelPrice,\r\n      time, other, period } = this.state;\r\n    const formItemLayout = {\r\n      labelCol: {\r\n        xs: { span: 16 },\r\n        sm: { span: 5 },\r\n      },\r\n      wrapperCol: {\r\n        xs: { span: 32 },\r\n        sm: { span: 19 },\r\n      },\r\n    };\r\n    const tailFormItemLayout = {\r\n      wrapperCol: {\r\n        xs: {\r\n          span: 24,\r\n          offset: 0,\r\n        },\r\n        sm: {\r\n          span: 16,\r\n          offset: 8,\r\n        },\r\n      },\r\n    };\r\n\r\n    return (this.props.user !== null && this.props.user.role === \"agent\" ? <TableWrapper>\r\n      <EditWrapper>\r\n        <Title>编辑路线</Title><br/>\r\n        <Form {...formItemLayout} onSubmit={this.handleSubmit}>\r\n          <Form.Item label=\"路线名\">\r\n            {getFieldDecorator('name', {\r\n              initialValue: name,\r\n              rules: [{\r\n                  required: true,\r\n                  message: \"请输入线路名！\",\r\n                },\r\n              ],\r\n            })(<Input/>)}\r\n          </Form.Item>\r\n          <Form.Item label=\"航班\">\r\n            {getFieldDecorator('flight', {\r\n              initialValue: flight,\r\n              rules: [{\r\n                  required: true,\r\n                  message: \"请输入航班号！\",\r\n                },\r\n              ],\r\n            })(<Input/>)}\r\n          </Form.Item>\r\n          <Form.Item label=\"航班价格\">\r\n            {getFieldDecorator('flightPrice', {\r\n              initialValue: flightPrice,\r\n              rules: [{\r\n                  required: true,\r\n                  message: \"请输入航班价格！\",\r\n                },{\r\n                  type: \"number\",\r\n                  message: \"请输入数字\"\r\n                }\r\n              ],\r\n            })(<InputNumber />)}\r\n          </Form.Item>\r\n          <Form.Item label=\"酒店\">\r\n            {getFieldDecorator('hotel', {\r\n              initialValue: hotel,\r\n              rules: [{\r\n                  required: true,\r\n                  message: \"请输入酒店名！\",\r\n                },\r\n              ],\r\n            })(<Input />)}\r\n          </Form.Item>\r\n          <Form.Item label=\"酒店价格\">\r\n            {getFieldDecorator('hotelPrice', {\r\n              initialValue: hotelPrice,\r\n              rules: [{\r\n                  required: true,\r\n                  message: \"请输入酒店价格！\",\r\n                },{\r\n                  type: \"number\",\r\n                  message: \"请输入数字\"\r\n                }\r\n              ],\r\n            })(<InputNumber />)}\r\n          </Form.Item>\r\n          <Form.Item label=\"其他费用\">\r\n            {getFieldDecorator('other', {\r\n              initialValue: other,\r\n              rules: [{\r\n                  required: true,\r\n                  message: \"请输入其他费用！\",\r\n                },{\r\n                  type: \"number\",\r\n                  message: \"请输入数字\"\r\n                }\r\n              ],\r\n            })(<InputNumber />)}\r\n          </Form.Item>\r\n          <Form.Item label=\"开始时间\">\r\n            {getFieldDecorator('time', {\r\n              initialValue: moment(time),\r\n              rules: [{\r\n                  type: \"object\",\r\n                  required: true,\r\n                  message: \"请输入开始时间！\",\r\n                }\r\n              ],\r\n            })(<DatePicker />)}\r\n          </Form.Item>\r\n          <Form.Item label=\"时长\">\r\n            {getFieldDecorator('period', {\r\n              initialValue: period,\r\n              rules: [{\r\n                  required: true,\r\n                  message: \"请输入时长！\",\r\n                },{\r\n                  type: \"number\",\r\n                  message: \"请输入数字\"\r\n                }\r\n              ],\r\n            })(<InputNumber />)}\r\n          </Form.Item>\r\n          <Form.Item {...tailFormItemLayout}>\r\n          <Button type=\"primary\" htmlType=\"submit\">\r\n            确定\r\n          </Button>\r\n        </Form.Item>\r\n        </Form>\r\n      </EditWrapper>\r\n    </TableWrapper> : <Redirect to=\"\" />);\r\n  }\r\n}\r\n\r\nconst mapStateToProps = (state) => ({\r\n  user: state.user\r\n});\r\n\r\nconst EditRoute = Form.create()(EditForm);\r\nexport default connect(mapStateToProps, null)(EditRoute);\r\n"],"sourceRoot":""}