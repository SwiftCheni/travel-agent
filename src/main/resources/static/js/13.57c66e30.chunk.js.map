{"version":3,"sources":["user/style.js","user/component/myBill.js"],"names":["LoginWrapper","styled","div","RegisterWrapper","TableWrapper","Expired","span","Revoke","EditWrapper","Title","h1","MyBill","this","props","user","role","init","id","bill","axios","get","key","then","res","data","success","msg","error","catch","console","log","info","columns","title","dataIndex","align","render","text","record","Date","end_time","onClick","revoke","bind","dataSource","bills","bordered","to","React","Component","connect","state","dispatch","userId","getMyBillAction"],"mappings":"y9CAEO,IAAMA,EAAeC,IAAOC,IAAV,KAOZC,EAAkBF,IAAOC,IAAV,KAOfE,EAAeH,IAAOC,IAAV,KAOZG,EAAUJ,IAAOK,KAAV,KASPC,EAASN,IAAOK,KAAV,KAQNE,EAAcP,IAAOC,IAAV,KAKXO,EAAQR,IAAOS,GAAV,M,uLCrCZC,E,4LAGqB,OAApBC,KAAKC,MAAMC,MAA0C,YAAzBF,KAAKC,MAAMC,KAAKC,MAC7CH,KAAKC,MAAMG,KAAKJ,KAAKC,MAAMC,KAAKG,M,6BAI7BC,GAAO,IAAD,OACXC,IAAMC,IAAN,2BAA8BF,EAAKG,MAAOC,MAAK,SAAAC,GAC1CA,EAAIC,KAAKC,SACV,IAAQA,QAAQF,EAAIC,KAAKE,KACzB,EAAKb,MAAMG,KAAK,EAAKH,MAAMC,KAAKG,KAC3B,IAAQU,MAAMJ,EAAIC,KAAKE,QAC7BE,OAAM,SAAAD,GACPE,QAAQC,IAAIH,GACZ,IAAQI,KAAK,+D,+BAIP,IAAD,OACDC,EAAU,CACd,CACEC,MAAO,qBACPC,UAAW,YACXb,IAAK,YACLc,MAAO,UAET,CACEF,MAAO,uCACPC,UAAW,UACXb,IAAK,UACLc,MAAO,UAET,CACEF,MAAO,uCACPC,UAAW,QACXb,IAAK,QACLc,MAAO,UAET,CACEF,MAAO,6CACPZ,IAAK,QACLa,UAAW,QACXC,MAAO,UAET,CACEF,MAAO,eACPZ,IAAK,SACLc,MAAO,SACPC,OAAQ,SAACC,EAAMC,GAGb,OAFY,IAAIC,KAAKD,EAAOE,UAChB,IAAID,KACI,kBAAC,IAAD,2BAAyB,kBAAC,IAAD,CAAQE,QAAS,EAAKC,OAAOC,KAAK,EAAML,IAAxC,+BAGnD,OAA4B,OAApB1B,KAAKC,MAAMC,MAA0C,YAAzBF,KAAKC,MAAMC,KAAKC,KAAqB,kBAAC,IAAD,KACvE,uBACEiB,QAASA,EACTY,WAAYhC,KAAKC,MAAMgC,MACvBC,UAAU,EACVb,MAAO,kBAAM,wBAAIE,MAAM,UAAV,gCAEC,kBAAC,IAAD,CAAUY,GAAG,U,GA/DdC,IAAMC,WAkFZC,uBAfS,SAACC,GACvB,MAAO,CACLN,MAAOM,EAAMN,MACb/B,KAAMqC,EAAMrC,SAIW,SAACsC,GAC1B,MAAO,CACLpC,KADK,SACAqC,GACHD,EAASE,YAAgBD,QAKhBH,CAA6CvC","file":"static/js/13.57c66e30.chunk.js","sourcesContent":["import styled from \"styled-components\";\r\n\r\nexport const LoginWrapper = styled.div`\r\n  width: 370px;\r\n  margin: 50px auto 0;\r\n  padding: 50px 20px;\r\n  background-color: #fff;\r\n`;\r\n\r\nexport const RegisterWrapper = styled.div`\r\n  width: 400px;\r\n  margin: 30px auto 0;\r\n  padding: 20px 20px 50px;\r\n  background-color: #fff;\r\n`;\r\n\r\nexport const TableWrapper = styled.div`\r\n  width: 100%;\r\n  background-color: #fff;\r\n  padding: 15px;\r\n  border-radius: 8px;\r\n`;\r\n\r\nexport const Expired = styled.span`\r\n  cursor: pointer;\r\n  padding: 5px 10px;\r\n  border-radius: 5px;\r\n  background-color: #f5f5f5;\r\n  color: #c9c9c9;\r\n  border: 1px solid #c9c9c9;\r\n`;\r\n\r\nexport const Revoke = styled.span`\r\n  cursor: pointer;\r\n  padding: 6px 11px;\r\n  border-radius: 5px;\r\n  background-color: #26bcd5;\r\n  color: #fff;\r\n`;\r\n\r\nexport const EditWrapper = styled.div`\r\n  width: 400px;\r\n  margin: 0 auto;\r\n`;\r\n\r\nexport const Title = styled.h1`\r\n  font-size: 20px;\r\n  font-weight: bold;\r\n  color: #38f;\r\n  text-align: center;\r\n`;\r\n","import React from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport { Redirect } from \"react-router-dom\";\r\nimport axios from \"axios\";\r\nimport { Table, message } from \"antd\";\r\nimport { getMyBillAction } from \"../../store/action\";\r\nimport { TableWrapper, Expired, Revoke } from \"../style\";\r\n\r\nclass MyBill extends React.Component {\r\n\r\n  componentDidMount() {\r\n    if(this.props.user !== null && this.props.user.role === \"visitor\") {\r\n      this.props.init(this.props.user.id);\r\n    }\r\n  }\r\n\r\n  revoke(bill) {\r\n    axios.get(`/route/revoke?id=${bill.key}`).then(res => {\r\n      if(res.data.success) {\r\n        message.success(res.data.msg);\r\n        this.props.init(this.props.user.id);\r\n      } else message.error(res.data.msg);\r\n    }).catch(error => {\r\n      console.log(error);\r\n      message.info(\"取消失败，发生异常\");\r\n    });\r\n  }\r\n\r\n  render() {\r\n    const columns = [\r\n      {\r\n        title: '线路名',\r\n        dataIndex: 'routeName',\r\n        key: 'routeName',\r\n        align: 'center'\r\n      },\r\n      {\r\n        title: '交通费（元）',\r\n        dataIndex: 'traffic',\r\n        key: 'traffic',\r\n        align: 'center'\r\n      },\r\n      {\r\n        title: '住宿费（元）',\r\n        dataIndex: 'hotel',\r\n        key: 'hotel',\r\n        align: 'center'\r\n      },\r\n      {\r\n        title: '其他费用（元）',\r\n        key: 'other',\r\n        dataIndex: 'other',\r\n        align: 'center'\r\n      },\r\n      {\r\n        title: '操作',\r\n        key: 'action',\r\n        align: 'center',\r\n        render: (text, record) => {\r\n          const end = new Date(record.end_time);\r\n          const now = new Date();\r\n          return (end < now ? <Expired>已过期</Expired> : <Revoke onClick={this.revoke.bind(this, record)}>取消预定</Revoke>)},\r\n      },\r\n    ];\r\n    return (this.props.user !== null && this.props.user.role === \"visitor\" ? <TableWrapper>\r\n      <Table \r\n        columns={columns} \r\n        dataSource={this.props.bills}\r\n        bordered={true}\r\n        title={() => <h1 align=\"center\">我的账单</h1>}\r\n      />\r\n    </TableWrapper> : <Redirect to=\"/\" />);\r\n  }\r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n  return {\r\n    bills: state.bills,\r\n    user: state.user\r\n  }\r\n};\r\n\r\nconst mapDispatchToProps = (dispatch) => {\r\n  return {\r\n    init(userId) {\r\n      dispatch(getMyBillAction(userId));\r\n    }\r\n  }\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(MyBill);\r\n"],"sourceRoot":""}